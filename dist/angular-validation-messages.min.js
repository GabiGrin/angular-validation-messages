!function(){"use strict";angular.module("gg.vmsgs",[])}(),function(){"use strict";angular.module("gg.vmsgs").directive("vmsg",["ValidationsHelper","$compile","$timeout",function(a,b){var c=a.defaultOptions,d=a.messageTriggers;return{scope:{messages:"="},require:["ngModel","^vmsgForm","^form"],compile:function(){return{pre:function(a){a.showMessage=!1,a._forceShowMessage=!1,a.errorMessage=""},post:function(e,f,g,h){function i(){k.$invalid?(e.showMessage=!0,e.errorMessage=j(),f.addClass(c.errorClass)):(e.showMessage=!1,e.errorMessage="",f.removeClass(c.errorClass))}function j(){var b,c,d=[],h=k.$viewValue;return angular.forEach(k.$error,function(a,b){a&&d.push(b)}),b=a.getPrioritizedErrorType(d),c=e.messages&&e.messages[b]||l.getMessage(b)||a.getMessage(b),a.renderMessage(c,b,f,g.fieldName,h)}var k=h[0],l=h[1],m={messageTrigger:g.messageTrigger||l.getControlMessageTrigger()||c.inputMessageTrigger},n=b(c.baseTemplate)(e),o=b(g.notificationTemplate||l.getNotificationTemplate()||c.notificationTemplate)(e);switch(n.append(o),f.after(n),f.data("vtValidationNode",n),m.messageTrigger){case d.onBlur:f.on("blur",function(){e.$apply(function(){i()})});break;case d.onDirty:e.$watch(function(){return k.$viewValue},function(){k.$dirty&&i()});break;case d.dontShow:break;default:throw new Error("Message trigger "+m.messageTrigger+" is not supported!")}e.$watch(function(){return k.$valid},function(a){a&&i()}),e.forceShowMessage=function(){e._forceShowMessage=k.$invalid,e.errorMessage=j()},e.hideMessage=function(){e._forceShowMessage=!1,e.showMessage=!1},e.$watch(function(){return k.$pristine},function(a){a&&(e.showMessage=!1,e._forceShowMessage=!1)}),e.setPristine=function(){k.$setPristine()},e.isInvalid=function(){return k.$invalid},l.addControl({control:e,element:f,messageElement:o})}}}}}])}(),function(){"use strict";angular.module("gg.vmsgs").directive("vmsgForm",["$parse","ValidationsHelper",function(a,b){var c=b.defaultOptions;return{restrict:"A",require:"form",scope:{notificationTemplate:"@",messages:"="},priority:-1,controller:["$scope",function(a){var b=a.controls=[];this.addControl=function(a){b.push(a)},this.removeControl=function(a){angular.forEach(b,function(c,d){a.name==c.elem.name&&b.splice(d,1)})},this.getControlMessageTrigger=function(){return a.controlsMessageTrigger},this.getNotificationTemplate=function(){return a.notificationTemplate},this.getMessage=function(b){return a.messages&&a.messages[b]}}],compile:function(){return{pre:function(a,b,c){a.controlsMessageTrigger=c.controlsMessageTrigger,a.notificationTemplate=c.notificationTemplate},post:function(b,d,e,f){function g(){var a=null;return angular.forEach(b.controls,function(b){!a&&b.control.isInvalid()&&(a=b)}),a}var h=a(e.submitError);d.bind("submit",function(a){f.$setDirty();var d=g(),i=e.animationClass||c.animationClass;angular.forEach(b.controls,function(a){b.$apply(a.control.forceShowMessage)}),d&&(h(b,{$event:event}),a.stopImmediatePropagation(),a.preventDefault(),c.scrollToFirstError?$("body").animate({scrollTop:d.element.offset().top-c.scrollDistance},c.scrollSpeed,null,function(){c.focusFirstError&&d.element.focus()}):c.focusFirstError&&d.element.focus(),i&&angular.forEach(b.controls,function(a){var b=a.messageElement;a.control.isInvalid()&&b.addClass(i).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){b.removeClass(i)})}))}),b.$watch(function(){return f.$pristine},function(a,c){a&&a!=c&&angular.forEach(b.controls,function(a){a.control.hideMessage()})})}}}}}])}(),function(){"use strict";angular.module("gg.vmsgs").provider("ValidationsHelper",function(){var a={minlength:function(a,b){var c=b.attr("ng-minlength");return'"'+a+'" is too short, at least '+c+" characters is required"},maxlength:function(a,b){var c=b.attr("ng-maxlength");return'"'+a+'" is too long, less than '+c+" characters is required"}},b={email:'"%FieldValue%" is not a valid e-mail address. You must enter a valid email!',required:"Field %FieldName% is required!",number:"Please insert a valid number",fallback:"There is a problem with this field. Please try again",min:"This field must be higher than %minimum%",max:"This field must be lower than %maximum%"},c={onBlur:"blur",dontShow:"none",immediate:"immediate",onDirty:"dirty"},d={inputMessageTrigger:c.onBlur,scrollToFirstError:!0,focusFirstError:!0,scrollDistance:50,scrollSpeed:"fast",errorClass:"validation-error",animationClass:"",baseTemplate:'<div ng-show="showMessage || _forceShowMessage"></div>',notificationTemplate:'<span class="small text-danger">{{errorMessage}}</span>'},e={required:-1};this.setMessage=function(a,c){return b[a]=c,this},this.getMessage=function(a){return b[a]},this.setCustomRenderer=function(b,c){return a[b]=c,this},this.getCustomRender=function(b){return a[b]},this.setErrorClass=function(a){return d.errorClass=a,this},this.setAnimationClass=function(a){return d.animationClass=a,this},this.setTypePriority=function(a,b){if(isNaN(b))throw new Error("Priority must be a number");return e[a]=b,this},this.setNotificationTemplate=function(a){/{{\s*errorMessage\s*}}/.test(a)||console.warn("Overriden templates must include {{errorMessage}} to properly display messages!"),d.notificationTemplate=a},this.setValidNotificationTemplate=function(a){/{{\s*validMessage\s*}}/.test(a)||console.warn("Overriden templates must include {{validMessage}} to properly display messages!"),d.validMessageTemplate=a},this.$get=function(){var a={getType:function(a,b){return"number"==b.attr("type")?"number":a},getMessage:function(a){return b[a]||b.fallback},renderMessage:function(a,b,c,d,e){var f=a.replace("%FieldValue%",e).replace("%FieldName%",d||"");switch(b){case"min":f.replace("%minimum%",c.attr("min"));break;case"max":f.replace("%maximum%",c.attr("max"))}return f},defaultOptions:d,messageTriggers:c,getPrioritizedErrorType:function(a){return a.sort(function(a,b){return(e[b]||0)-(e[a]||0)}),a[0]}};return a}})}();