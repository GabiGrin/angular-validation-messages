"use strict";angular.module("gg.vmsgs",[]),function(){angular.module("gg.vmsgs").directive("vmsgForm",["$parse",function(a){return{restrict:"A",require:"form",priority:-1,compile:function(){return{pre:function(b,c,d){b.formOpts=a(d.vmsgForm||"")(b),c.attr("novalidate","novalidate"),b.$watch(function(){return d.vmsgForm},function(c){b.formOpts=a(c||"")(b)})},post:function(a,b,c,d){b.bind("submit",function(b){d.$invalid&&(b.stopImmediatePropagation(),a.$broadcast("submit"))})}}},controller:["$scope",function(a){this.getOptions=function(){return a.formOpts}}]}}])}(),function(){angular.module("gg.vmsgs").factory("ValidationMessagesHelper",["$compile",function(a){var b=["required","email","url","minlength","maxlength","pattern","min","max"],c={hideClassName:"ng-hide",messageClassName:"validation-message",messageTemplate:"<span><msg></msg></span>",showTrigger:"blur",hideTrigger:"valid",dummy:!1,errorMessages:{},parentContainerClassName:"form-group",parentErrorClassName:"has-error",parentSuccessClassName:""};return{setOptions:function(a){c=angular.extend({},c,a||{}),a&&angular.forEach(a,function(c,d){"ERRORMESSAGES"===d.toUpperCase()&&angular.forEach(a[d],function(a,c){-1===b.indexOf(c)&&b.push(c)})})},getOptions:function(a,b){return angular.extend({},c,b||{},a||{})},showTriggers:["blur","submit","keydown","keyup"],hideTriggers:["valid","keydown","keyup"],errorKeys:b,errorMessages:{required:{"default":"This field is required",email:"A valid e-mail address is required",number:"A valid number is required",date:"A valid date is required",week:"A valid week is required",url:"A valid url is required",month:"A valid month is required"},url:"A valid url is required",email:"A valid e-mail address is required",minlength:"This field must be at least {minlength} chars",maxlength:"This field must be less than {maxlength} chars",min:{"default":"This field must be higher than {min}",number:"This number must be higher than {min}",date:"This date must be after {min}",week:"This week must be after {min}",month:"This month must be after {min}"},max:{"default":"This field must be lower than {max}",number:"This number must be lower than {max}",date:"This date must be before {max}",week:"This week must be before {max}",month:"This month must be before {max}"},pattern:"This field must match a specific pattern {pattern}"},renderError:function(a){var b;return b=arguments,2===b.length&&null!==b[1]&&"object"==typeof b[1]&&(b=b[1]),a.replace(/{([^}]*)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})},_getErrorMessage:function(a,b,c,d){var e=d&&d.errorMessages&&d.errorMessages[a],f=e||this.errorMessages[a];if(f)return this.renderError(f[b]||f.default||f,c);throw"Error message not supported for type "+a+" and inputType "+b},getRenderParameters:function(a){var b={};return["minlength","maxlength","min","max","pattern"].forEach(function(c){var d=a.attr(c)||a.attr("ng-"+c);d&&(b[c]=d)}),b},getErrorMessage:function(a,b,c){var d=b.attr("type"),e="",f=this.getRenderParameters(b);return this.errorKeys.forEach(function(b){!e&&a[b]&&(e=b)}),this._getErrorMessage(e,d,f,c)},createMessageElement:function(b,c){return a(c.messageTemplate)(b).addClass(c.messageClassName).addClass(c.hideClassName)}}}])}(),function(){angular.module("gg.vmsgs").directive("vmsg",["ValidationMessagesHelper","$parse",function(a,b){return{require:["ngModel","^vmsgForm"],restrict:"A",compile:function(){return function(c,d,e,f){var g=b(e.vmsg||"")(c),h=f[1].getOptions(),i=a.getOptions(g,h),j=a.createMessageElement(c,i),k=f[0],l=d.parent(),m=function(){k.$invalid?(window.ngModelCtrl=k,j.removeClass(i.hideClassName),d.parent().hasClass(i.parentContainerClassName)&&l.addClass(i.parentErrorClassName)):l.hasClass(i.parentContainerClassName)&&(console.log("opts.parentSuccessClassName",i.parentSuccessClassName),l.addClass(i.parentSuccessClassName))},n=function(){j.addClass(i.hideClassName),l.hasClass(i.parentContainerClassName)&&(l.removeClass(i.parentErrorClassName),l.removeClass(i.parentSuccessClassName))};switch(d.data("message-element",j),d.after(j),i.showTrigger){case"blur":case"keydown":case"keyup":d.on(i.showTrigger,function(){m()});break;case"submit":break;default:throw'Show trigger "'+i.showTrigger+'" is not supported'}switch(c.$on("submit",function(){m()}),i.hideTrigger){case"valid":c.$watch(function(){return k.$valid},function(a,b){a!==b&&n()});break;case"keydown":case"keyup":d.on(i.hideTrigger,function(){n()});break;default:throw"Unsupported hide trigger used"}c.$watch(function(){return k.$error},function(b){k.$invalid&&j.find("msg").text(a.getErrorMessage(b,d,i))},!0)}}}}])}();