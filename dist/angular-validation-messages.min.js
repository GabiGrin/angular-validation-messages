!function(){"use strict";angular.module("validations",[])}(),angular.module("validations").provider("ValidationsHelper",function(){var a={minlength:function(a,b){var c=b.attr("ng-minlength");return'"'+a+'" is too short, at least '+c+" characters is required"},maxlength:function(a,b){var c=b.attr("ng-maxlength");return'"'+a+'" is too long, less than '+c+" characters is required"}},b={email:'%FieldValue%" is not a valid e-mail address. You must enter a valid email!',required:"Field %FieldName% is required!",number:"Please insert a valid number",fallback:"There is a problem with this field. Please try again",min:"This field must be higher than %minimum%",max:"This field must be lower than %maximum%"},c={onBlur:"blur",dontShow:"none",immediate:"immediate",onDirty:"dirty"},d={inputMessageTrigger:c.onBlur,scrollToFirstError:!0,focusFirstError:!0,scrollDistance:50,scrollSpeed:"fast",errorClass:"validation-error",animationClass:"",baseTemplate:'<div ng-show="showMessage || _forceShowMessage"></div>',notificationTemplate:'<span class="small text-danger">{{errorMessage}}</span>'},e={required:-1};this.setMessage=function(a,c){return b[a]=c,this},this.getMessage=function(a){return b[a]},this.setCustomRenderer=function(b,c){return a[b]=c,this},this.getCustomRender=function(b){return a[b]},this.setErrorClass=function(a){return d.errorClass=a,this},this.setAnimationClass=function(a){return d.animationClass=a,this},this.setTypePriority=function(a,b){if(isNaN(b))throw new Error("Priority must be a number");return e[a]=b,this},this.setNotificationTemplate=function(a){/{{\s*errorMessage\s*}}/.test(a)||console.warn("Overriden templates must include {{errorMessage}} to properly display messages!"),d.notificationTemplate=a},this.$get=function(){return{renderMessage:function(c,d,e,f){function g(a){var c=b[a]||b.fallback;return c.replace("%FieldValue%",f).replace("%FieldName%",e||"")}var h=d.attr("type"),i="";switch(c){case"min":i=g(c).replace("%minimum%",d.attr("min"));break;case"max":i=g(c).replace("%maximum%",d.attr("max"));break;default:i="number"==h?g("number"):a[c]?a[c](f,d,e):g(c)}return i},defaultOptions:d,messageTriggers:c,getPrioritizedErrorType:function(a){return a.sort(function(a,b){return(e[b]||0)-(e[a]||0)}),a[0]}}}}).directive("blacklist",function(){return{require:"ngModel",link:function(a,b,c,d){var e=c.blacklist.split(",");d.$parsers.unshift(function(a){var b=-1===e.indexOf(a);return d.$setValidity("blacklist",b),b?a:void 0}),d.$formatters.unshift(function(a){return d.$setValidity("blacklist",-1===e.indexOf(a)),a})}}}),angular.module("validations").directive("vt",["ValidationsHelper","$compile","$timeout",function(a,b,c){var d=a.defaultOptions,e=a.messageTriggers;return{scope:{},require:["ngModel","^vtForm","^form"],compile:function(){return function(f,g,h,i){function j(){l.$invalid?(f.showMessage=!0,f.errorMessage=k(),g.addClass(d.errorClass)):(f.showMessage=!1,f.errorMessage="",g.removeClass(d.errorClass))}function k(){var b,c=[],d=l.$viewValue;return angular.forEach(l.$error,function(a,b){a&&c.push(b)}),b=a.getPrioritizedErrorType(c),a.renderMessage(b,g,h.fieldName,d)}var l=i[0],m=i[1],n={messageTrigger:h.messageTrigger||m.getControlMessageTrigger()||d.inputMessageTrigger},o=b(d.baseTemplate)(f),p=b(h.notificationTemplate||m.getNotificationTemplate()||d.notificationTemplate)(f);switch(o.append(p),g.after(o),g.data("vtValidationNode",o),f.showMessage=!1,f._forceShowMessage=!1,f.errorMessage="",window.dirScope=f,n.messageTrigger){case e.onBlur:g.on("blur",function(){f.$apply(function(){j()})});break;case e.immediate:f.$watch(function(){return l.$viewValue},j),c(j);break;case e.onDirty:f.$watch(function(){return l.$viewValue},function(){l.$dirty&&j()})}f.forceShowMessage=function(){f._forceShowMessage=l.$invalid,f.errorMessage=k()},f.hideMessage=function(){f._forceShowMessage=!1,f.showMessage=!1},f.$watch(function(){return l.$pristine},function(a){a&&(f.showMessage=!1,f._forceShowMessage=!1)}),f.setPristine=function(){l.$setPristine()},f.isInvalid=function(){return l.$invalid},m.addControl({control:f,element:g,messageElement:p})}}}}]),angular.module("validations").directive("vtForm",["$parse","ValidationsHelper",function(a,b){var c=b.defaultOptions;return{restrict:"A",require:"form",scope:{notificationTemplate:"@"},priority:-1,controller:["$scope",function(a){var b=a.controls=[];this.addControl=function(a){b.push(a)},this.removeControl=function(a){angular.forEach(b,function(c,d){a.name==c.elem.name&&b.splice(d,1)})},this.getControlMessageTrigger=function(){return a.controlsMessageTrigger},this.getNotificationTemplate=function(){return a.notificationTemplate}}],compile:function(){return{pre:function(a,b,c){a.controlsMessageTrigger=c.controlsMessageTrigger,a.notificationTemplate=c.notificationTemplate},post:function(b,d,e,f){function g(){var a=null;return angular.forEach(b.controls,function(b){!a&&b.control.isInvalid()&&(a=b)}),a}var h=a(e.submitError);d.bind("submit",function(a){f.$setDirty();var d=g(),i=e.animationClass||c.animationClass;angular.forEach(b.controls,function(a){b.$apply(a.control.forceShowMessage)}),d&&(h(b,{$event:event}),a.stopImmediatePropagation(),a.preventDefault(),c.scrollToFirstError?$("body").animate({scrollTop:d.element.offset().top-c.scrollDistance},c.scrollSpeed,null,function(){c.focusFirstError&&d.element.focus()}):c.focusFirstError&&d.element.focus(),i&&(console.log("ani",i),angular.forEach(b.controls,function(a){var b=a.messageElement;a.control.isInvalid()&&b.addClass(i).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){b.removeClass(i)})})))}),b.$watch(function(){return f.$pristine},function(a,c){a&&a!=c&&angular.forEach(b.controls,function(a){a.control.hideMessage()})})}}}}}]);